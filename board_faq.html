<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- <link rel="stylesheet" type="text/css" href="css/style.css" /> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>메타포레스트 : FAQ</title>

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link href="fonts/NexonLv2Gothic/nexonlv2gothic.css" rel="stylesheet">
    <link href="fonts/ProximaNova/proximanova.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=DM+Sans:400,400i,500,700&family=Raleway:wght@800&display=swap' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <!-- Favicons -->
    <link rel="shortcut icon" href="./img/favicon.ico">
    
    <!-- css-->
    <link rel="stylesheet" href="css/custom.css">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  </head>
  <body>
    <!-- Top navigation -->
    <div class="topnav">
      <!-- Logo -->
      <div class="topnav-logo">
        <a href="./index.html" class="">
          <img class="" src="img/logo/log03.png" alt="logo">
        </a>
      </div>

      <!-- Right-aligned links -->
      <div class="topnav-right">
        <ul class="" id="">
          <li class="">
            <a href="./index.html#home" class="nav-link font-NXN" aria-haspopup="true">HOME</a>
          </li>
          <li>
            <a href="./index.html#page1Link" class="nav-link font-NXN">서비스 장점</a>
          </li>
          <li>
            <a href="./index.html#page2Link" class="nav-link font-NXN">서비스 소개</a>
          </li>
          <li>
            <a href="./index.html#page4Link" class="nav-link font-NXN">프렌즈</a>
          </li>
          <li>
            <a href="./index.html#page3Link" class="nav-link font-NXN">파트너쉽</a>
          </li>
          <li>
            <a href="./index.html#page5Link" class="nav-link font-NXN">고객지원</a>
          </li>
          <!-- <li>
            <a href="" class="nav-link fa fa-bars"></a>
          </li> -->
        </ul>
      </div>

    </div>
    </br>
    
    <div class="category">
      
      <a href="./board_main.html">공지사항</a>
      <!-- <a href="./board_event.html">이벤트</a> -->
      <a href="./board_faq.html" class="active">FAQ</a>
      <a href="http://yatavent.com/contact">문의사항</a>
      
    </div>
    </br>

    <div id="board_area">

      <h1>FAQ (자주 묻는 질문)</h1>
      <h4>메타포레스트 사용에 대해 자주 묻는 질문과 답변을 확인해보세요.</h4>


      <div class="category-manual">
        <a href="javascript:void(0);" class="list-group-item on" onclick="apiGetCount();">전체</a>
        <a href="javascript:void(0);" class="list-group-item" onclick="apiGetListByCategory(10);">프로그램 사용</a>
        <a href="javascript:void(0);" class="list-group-item" onclick="apiGetListByCategory(20);">심리 상담</a>
        <a href="javascript:void(0);" class="list-group-item" onclick="apiGetListByCategory(30);">기관 등록</a>
        <a href="javascript:void(0);" class="list-group-item" onclick="apiGetListByCategory(40);">회원관리</a>
        <a href="javascript:void(0);" class="list-group-item" onclick="apiGetListByCategory(50);">기타</a>
      </div>

      </br>

      <div id="accordion_wrap">
      </div>

      <!-- <button type="button" class="btn_bk" onclick="location.href='board_write.html' ">등록</button> -->
    </br>
    <!-- <button type="button" class="btn_bk btn_new">등록</button> -->
    <span class="btn_del">답변이 충분하지 않은 경우 고객센터로 문의주세요.</span>
    

    </br>

     <!---paging number --->
     <ul id="pagingul">
     </ul>

    </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">

      <div class="footer-top">
        <div class="footer-left">
          <div class="logo">
            <img class="logo" src="img/logo/log03.png" alt="logo">
          </div>
        </div>
        <div class="footer-right">
        </div>
      </div>

      <div class="footer-middle">
        <div class="btn-download">
          <img src="img/button/btn-download.png" alt="download">
        </div>
      </div>

      <div class="footer-bottom">
        <div>
          <div class="footer-info">
            <ul>
              <li>주식회사 야타브엔터 (<a href="http://www.yatavent.com" target="_blank">www.yatavent.com</a>)</li>
              <li>주소 | 서울특별시 성동구 뚝섬로17가길 48</li>
              <li>Mail | yatavent@yatavent.com</li>
              <li>Tel | 02-2039-00633</li>
              <li>사업자등록번호 | 750-88-01121</li>
            </ul>
          </div>

          <div class="footer-copyright">
            <span class="copyright">
              Copyright &copy; <a href="http://www.yatavent.com" target="_blank">YATAVENT</a>
              Corp. All rights reserved.
            </span>
          </div>
        </div>
        
        <div class="footer-socials">
          <div>
            <a href="https://www.instagram.com/metaforest.official/?hl=ko" target="_blank" class="social-instagram"
              aria-label="instagram" title="instagram" target="_blank">
              <i class="fa fa-instagram" aria-hidden="true"></i>
            </a>
          </div>
          <div>
            <a href="https://www.instagram.com/metaforest.official/?hl=ko" class="social social-blog" target="_blank"
              aria-label="blog" title="blog" target="_blank">
              <i class="fa fa-blog"></i>
            </a>
          </div>
          <div>
            <a href="https://www.facebook.com/profile.php?id=100075394868765" target="_blank" class=" social-facebook"
              aria-label="facebook" title="facebook" target="_blank">
              <i class="fa fa-facebook" aria-hidden="true"></i>
            </a>
          </div>
          <div class="contact">
            <span></span>
            <a href="http://yatavent.com/contact">Contact</a>
          </div>
        </div>
        
      </div>

    </div> <!-- end container -->
  </footer> <!-- end footer -->

  <script src='./tools/cfg.js'></script>
  <script src='./tools/enums.js'></script>
  <script src='./tools/libs.js'></script>
  <script src='./tools/md5.js'></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  
  <script>
    'use strict'   
    function buildTable(data) { 
      let acc = document.getElementById('accordion_wrap');
      console.log('acc: ', acc)
      acc.innerHTML = '';
      let row = '';
      for (var i=0; i < data.length; i++) { 
        // row = `<tr> <td class="center"></td><td style="text-align:center">${data[i].manualId}</td> <td style="text-align:left">${data[i].type}</td> <td style="text-align:left">${data[i].title}</td> <td style="text-align:center"><a class="accordion" >${data[i].content}</a><div class="panel"><p>${data[i].title}</p></div></td> </tr>`;
        row = `<div class="que">
        <span class="q_cate">${eFaqCategory[undefinedToString(data[i].category)]}</span>
        <span class="q_tit">${data[i].title}</span>
        </div>
        <div class="anw">
        <span>${data[i].content}</span>
        </div>`;
        acc.innerHTML += row 
      } 
    }
  </script>

  <script>
    $(".list-group-item").click(function() {
          
        // Select all list items
        var listItems = $(".list-group-item");
          
        // Remove 'on' tag for all list items
        for (let i = 0; i < listItems.length; i++) {
            listItems[i].classList.remove("on");
        }
          
        // Add 'on' tag for currently selected item
        this.classList.add("on");
    });
  </script>

  <!-- <script>
    'use strict'
    let addButton = document.querySelector('.btn_new');
    addButton.onclick = async function () {
      let accessLevel = storageGet('accessLevel', 0);
      if (accessLevel < 30) {
        alert('등록 권한이 없습니다.');
        return
      }
      window.location.href = './board_faq_write.html'
    }
  </script> -->

  <script>
    'use strict'
    const apiGetList = async (_perPage) => {
      try {
        const _response = await axios.post(apiUrl+'faq', {
          msgType: eApiMessageType.USER_GET_LIST_FAQ_REQ,
          // msgType: eApiMessageType.USER_GET_LIST_FAQ_BY_CATEGORY_REQ,
          data: {
            page: _perPage,
            // category: _category
          }
        }, {withCredentials: true})

        let response = {}
        Object.assign(response, _response.data)

        console.log(response)
        console.log(response.data)

        if (response.status !== 200) {
          console.log(response)
          return
        }
        globalCurrentPage = _perPage;
        paging(totalData, _perPage);
        buildTable(response.data.rows)

      } catch (err) {
        console.error(err)
      }
    };

  </script>

  <script>
    'use strict'

    let totalData; // 총 데이터 수 
    let dataPerPage = 10;
    let pageCount = 5;
    let globalCurrentPage = 1; // 현재 페이지


    window.onload = function () {
      apiGetCount();
    }


    const apiGetCount = async () => {
      try {
        const _response = await axios.post(apiUrl +'faq', {
          msgType: eApiMessageType.USER_GET_COUNT_FAQ_REQ,
          data: {
            // category: _category
          }
        }, {withCredentials: true})

        let response = {}
        Object.assign(response, _response.data)

        console.log(response)
        console.log(response.data)

        totalData = response.data.rows.length
        console.log("totalData : " + totalData);

        await paging(totalData, globalCurrentPage);
        // await apiGetList(globalCurrentPage, _category);
        await apiGetList(globalCurrentPage);

        $(".que").click(function() {
          $(this).next(".anw").stop().slideToggle(300);
          $(this).toggleClass('on').siblings().removeClass('on');
          $(this).next(".anw").siblings(".anw").slideUp(300); // 1개씩 펼치기
        });

      } catch (err) {
        console.error(err)
      }
    };

    const apiGetListByCategory = async (_category) => {
      try {
        let _perPage = 1;
        const _response = await axios.post(apiUrl+'faq', {
          msgType: eApiMessageType.USER_GET_LIST_FAQ_BY_CATEGORY_REQ,
          data: {
            page: _perPage,
            category: _category
          }
        }, {withCredentials: true})

        let response = {}
        Object.assign(response, _response.data)

        console.log(response)
        console.log(response.data)

        if (response.status !== 200) {
          console.log(response)
          return
        }
        globalCurrentPage = _perPage;
        paging(totalData, _perPage);
        buildTable(response.data.rows);

        $(".que").click(function() {
          $(this).next(".anw").stop().slideToggle(300);
          $(this).toggleClass('on').siblings().removeClass('on');
          $(this).next(".anw").siblings(".anw").slideUp(300); // 1개씩 펼치기
        });

      } catch (err) {
        console.error(err)
      }
    };


    // paging 함수
    function paging(totalData, currentPage) {

      console.log("totalData : " + totalData);
      console.log("currentPage : " + currentPage);

      let totalPage = Math.ceil(totalData / dataPerPage); // 총 페이지 수
      console.log("totalPage : " + totalPage);

      console.log("pageCount : " + pageCount);

      if (totalPage < pageCount) {
        pageCount = totalPage;
      }        

      let pageGroup = Math.ceil(currentPage / pageCount); // 페이지 그룹
      console.log("pageGroup : " + pageGroup);

      let last = pageGroup * pageCount // 화면에 보여질 마지막 페이지 번호
      console.log("last : " + last);

      if (last > totalPage) {
        last = totalPage;
      }

      let first = last - (pageCount - 1); // 화면에 보여질 첫번째 페이지 번호
      console.log("first : " + first);
      let next = last + 1;
      let prev = first - 1;

      let pageHtml = "";

      pageHtml += "<li><a class='pageIdx' id='first' onclick=apiGetList(" + (first.toString()) + ")> |< </a></li>";

      if (prev > 0) {
        pageHtml += "<li><a class='pageIdx' id='prev' onclick=apiGetList(" + (prev.toString()) + ")> < </a></li>";
      }

      // 페이징 번호 표시
      for (let i = first; i<=last; i++) {
        if(currentPage === i) {
          pageHtml += "<li class='on'><a class='pageIdx' onclick=apiGetList(" + (i.toString()) + ")>" + i + "</a></li>";
        } else {
          pageHtml += "<li class='on'><a class='pageIdx' onclick=apiGetList(" + (i.toString()) + ")>" + i + "</a></li>";
        }
      }

      if (last < totalPage) {
        pageHtml += "<li><a id='next' onclick=apiGetList(" + (next.toString()) + ")> > </a></li>";
      }

      pageHtml += "<li><a class='pageIdx' id='last' onclick=apiGetList(" + (last.toString()) + ")> >| </a></li>";

      document.querySelector('#pagingul').innerHTML = pageHtml;
    }


  </script>
  
  <script>
    'use strict'
    window.onunload = function () {
      storageClear();
    }
  </script>

</body>
</html>
